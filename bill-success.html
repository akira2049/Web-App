<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Payment Successful</title>
  <link rel="stylesheet" href="transfer.css">
  <style>
    .centerCard{
      max-width:720px;
      margin:32px auto;
    }
    .successIcon{
      font-size:48px;
      line-height:1;
    }
    .mainTitle{
      font-size:22px;
      font-weight:900;
      color:var(--primary);
      line-height:1.3;
      margin-top:8px;
    }
    .smallMeta{
      font-size:14px;
      color:var(--muted);
      margin-top:4px;
      line-height:1.4;
    }
    .pairGrid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
      margin-top:20px;
    }
    @media(max-width:700px){
      .pairGrid{grid-template-columns:1fr;}
    }
    .boxOutline{
      border:1px solid var(--border);
      border-radius:12px;
      background:#fbfbfc;
      padding:14px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      min-height:100px;
    }
    .kvLabel{
      font-size:12px;
      font-weight:700;
      color:var(--muted);
      margin-bottom:4px;
    }
    .kvMain{
      font-size:20px;
      font-weight:800;
      color:var(--primary);
      line-height:1.3;
      word-break:break-word;
    }
    .kvSub{
      font-size:13px;
      color:var(--muted);
      line-height:1.3;
      margin-top:4px;
    }
    .actionsRow{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:20px;
    }
    .btnPrimary{
      display:inline-flex;
      justify-content:center;
      align-items:center;
      padding:14px 18px;
      border:none;
      border-radius:14px;
      font-weight:800;
      font-size:16px;
      background:var(--primary);
      color:#fff;
      cursor:pointer;
      text-decoration:none;
    }
    .btnGhost{
      display:inline-flex;
      justify-content:center;
      align-items:center;
      padding:14px 18px;
      border:1px solid var(--border);
      border-radius:14px;
      font-weight:700;
      font-size:16px;
      background:#fff;
      color:var(--primary);
      cursor:pointer;
      text-decoration:none;
    }
    @media print{ .no-print{display:none;} }
  </style>
</head>
<body>
  <div class="app centerCard card">
    <div class="section">

      <div class="successIcon">✅</div>
      <div class="mainTitle">Payment Successful</div>
      <div class="smallMeta" id="successTime">--</div>

      <div class="pairGrid" style="margin-top:16px;">
        <div class="boxOutline">
          <div class="kvLabel">TOTAL PAID (BDT)</div>
          <div class="kvMain" id="paidAmount">0.00</div>
          <div class="kvSub" id="feeText">includes fees: BDT 0.00</div>
        </div>

        <div class="boxOutline">
          <div class="kvLabel">BILLER</div>
          <div class="kvMain" id="billerName">Link3</div>
          <div class="kvSub" id="billerCust">Customer ID : 50589</div>
        </div>
      </div>

      <div class="pairGrid" style="margin-top:16px;">
        <div class="boxOutline">
          <div class="kvLabel">PAID FROM</div>
          <div class="kvMain" id="fromAccount">Acc. 14512400000072</div>
          <div class="kvSub">Payment source</div>
        </div>

        <div class="boxOutline">
          <div class="kvLabel">TRANSACTION ID</div>
          <div class="kvMain" id="txnId">BILL-000000</div>
          <div class="kvSub">Keep this for reference</div>
        </div>
      </div>

      <div class="actionsRow">
        <button class="btnPrimary" id="downloadReceipt">Download PDF receipt</button>
        <a class="btnGhost" href="bill-payments.html">Pay another bill</a>
      </div>

    </div>
  </div>

<script>
  function randChunk(n){
    return Math.floor(Math.random()*n).toString().padStart(4,'0');
  }

  const billName   = localStorage.getItem('bill_name') || 'Link3';
  const billCustId = localStorage.getItem('bill_id')   || '50589';
  const billAmt    = localStorage.getItem('bill_amt')  || '50.00';
  const billFrom   = localStorage.getItem('bill_from') || '14512400000072';

  const txnId = 'BILL-' + Date.now().toString().slice(-6) + '-' + randChunk(10000);
  const nowStr = new Date().toLocaleString();

  document.getElementById('paidAmount').textContent = parseFloat(billAmt).toFixed(2);
  document.getElementById('billerName').textContent = billName;
  document.getElementById('billerCust').textContent = 'Customer ID : ' + billCustId;
  document.getElementById('fromAccount').textContent = 'Acc. ' + billFrom;
  document.getElementById('txnId').textContent = txnId;
  document.getElementById('successTime').textContent = nowStr;
  document.getElementById('feeText').textContent = 'includes fees: BDT 0.00';

  function buildReceiptHTML(){
    return `
<!doctype html>
<html>
<head><meta charset="utf-8"><title>Bill Payment Receipt</title>
<style>
  body{margin:24px;}
  body,table{
    font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    color:#1b1b1f;
  }
  .rc-header{
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
  }
  .rc-title{
    font-size:22px;
    font-weight:900;
    margin:0 0 8px 0;
    line-height:1.3;
    color:#1b1b1f;
  }
  .rc-meta{
    color:#374151;
    font-size:12px;
    line-height:1.4;
    margin-bottom:12px;
  }
  .rc-org{
    text-align:right;
    font-size:12px;
    line-height:1.3;
    color:#1b1b1f;
  }
  .rc-org-name{
    font-weight:800;
    font-size:14px;
    color:#1b1b1f;
  }
  table{
    width:100%;
    border-collapse:collapse;
    margin-top:8px;
    font-size:13px;
    line-height:1.4;
  }
  th,td{
    border:1px solid #e5e7eb;
    padding:8px 10px;
    text-align:left;
    vertical-align:top;
  }
  .rc-summary{
    margin-top:12px;
    border:1px solid #e5e7eb;
    padding:10px;
    border-radius:8px;
    font-size:14px;
    line-height:1.4;
    color:#1b1b1f;
  }
  .rc-foot{
    margin-top:18px;
    font-size:12px;
    color:#6b7280;
    line-height:1.4;
  }
  @media print{ .no-print{display:none;} }
</style>
</head>
<body>
  <div class="rc-header">
    <div>
      <div class="rc-title">Bill Payment Receipt</div>
      <div class="rc-meta">
        Transaction ID: ${txnId}<br>
        Date: ${nowStr}
      </div>
    </div>
    <div class="rc-org">
      <div class="rc-org-name">Shanto Banking</div>
      <div>Customer Portal</div>
    </div>
  </div>

  <table>
    <tr><th>Biller Name</th><td>${billName}</td></tr>
    <tr><th>Customer ID</th><td>${billCustId}</td></tr>
    <tr><th>Paid From Account</th><td>Acc. ${billFrom}</td></tr>
    <tr><th>Amount (BDT)</th><td>${parseFloat(billAmt).toFixed(2)}</td></tr>
    <tr><th>Fee (BDT)</th><td>0.00</td></tr>
    <tr><th>Total (BDT)</th><td>${parseFloat(billAmt).toFixed(2)}</td></tr>
    <tr><th>Status</th><td>SUCCESS</td></tr>
  </table>

  <div class="rc-summary">
    Payment to ${billName} (Customer ID ${billCustId}) was successful.
    Keep this receipt for your records.
  </div>

  <div class="rc-foot">
    Generated by Shanto Banking System • ${new Date().toLocaleString()}
  </div>

  <button class="no-print"
    onclick="window.print()"
    style="margin-top:16px;padding:8px 12px;border:1px solid #e5e7eb;border-radius:8px;cursor:pointer;">
    Print / Save as PDF
  </button>

</body>
</html>
    `;
  }

  document.getElementById('downloadReceipt').addEventListener('click', ()=>{
    const popup = window.open('', '_blank', 'width=800,height=900');
    popup.document.open();
    popup.document.write(buildReceiptHTML());
    popup.document.close();
    setTimeout(()=>{ popup.print(); }, 250);
  });
</script>
</body>
</html>
